<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title>MetaBrainz Summit 2018 - Resources</title><meta charset="UTF-8"></meta><meta name="generator" content="Hovercraft! 1.0 http://regebro.github.com/hovercraft"></meta><link rel="stylesheet" href="css/hovercraft.css" media="all"></link><link rel="stylesheet" href="css/impressConsole.css" media="all"></link><link rel="stylesheet" href="css/highlight.css" media="all"></link><link rel="stylesheet" href="mb2018.css" media="screen,projection"></link><script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        showProcessingMessages: false,
        messageStyle: "none",
        TeX : { extensions : ['color.js'] }
      });
    </script></head><body class="impress-not-supported"><div class="header"><blockquote><img src="images/background.png"></img></blockquote></div><div id="impress" data-transition-duration="1500"><div class="step step-level-1" step="0" data-x="0" data-y="0" data-z="0" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" scale="1" data-scale="1"><h1 id="metabrainz-summit-2018">MetaBrainz Summit 2018</h1><h2 id="our-infrastructure">Our infrastructure</h2></div><div class="step step-level-1" step="1" data-rotate-z="45" data-x="2000" data-y="0" data-rotate-x="0" data-rotate-y="0" data-scale="1" data-z="0"><h1 id="number-of-servers">Number of servers</h1><ul><li>Hetzner: 20 physical machines</li><li>Hetzner Cloud: 8 virtual machines</li><li>Google Cloud: 12 active instances</li><li>Total: <strong>40 servers</strong></li></ul><div class="notes"><p>TODO</p></div></div><div class="step step-level-1" step="2" data-x="1000" data-y="-1000" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="1" data-z="0"><h1 id="memory-storage-processing-power">Memory, storage, processing power</h1><ul><li>1.5 Terabytes of RAM</li><li>18 Terabytes of storage</li><li>1.7M Bogomips on 240 CPU cores</li></ul><div class="notes"><p>TODO.</p></div></div><div class="step step-level-1" step="3" data-rotate-x="0" data-rotate-y="0" data-rotate-z="135" data-scale="1" data-x="0" data-y="-2000" data-z="0"><h1 id="network-traffic">Network traffic</h1><ul><li><em>180 Terabytes</em> served this year</li><li><em>~50 mbits/s</em> out, <em>20 mbits/s</em> in</li></ul><div class="notes"><p>TODO</p></div></div><div class="step step-level-1" step="4" data-rotate-x="0" data-rotate-y="0" data-rotate-z="180" data-scale="1" data-x="-1000" data-y="-3000" data-z="0"><img src="images/ping_latency_world.png" height="600px"></img></div><div class="step step-level-1" step="5" id="mbs1" data-rotate-x="0" data-rotate-y="0" data-rotate-z="225" data-scale="1" data-x="-2000" data-y="-4000" data-z="0"><h1 id="musicbrainz-services">MusicBrainz services</h1><p>Number of queries served this year</p><p><strong>11 Billions</strong> of 200s answers</p></div><div class="step step-level-1" step="6" data-rotate-x="0" data-rotate-y="0" data-rotate-z="270" data-scale="1" data-x="-3000" data-y="-5000" data-z="0"><h1 id="id1">MusicBrainz services</h1><ul><li>Incoming Requests: <em>850 req/s</em></li><li>Handled by upstreams: <strong>280 req/s</strong></li></ul></div><div class="step step-level-1" step="7" data-rotate-x="0" data-rotate-y="0" data-rotate-z="315" data-scale="1" data-x="-4000" data-y="-6000" data-z="0"><h1 id="post-qnap">Post QNAP</h1><p>Bandwidth usage went from</p><p><em>120</em> mbits/s to <em>50</em> mbits/s</p></div><div class="step step-level-1" step="8" data-rotate-x="0" data-rotate-y="0" data-rotate-z="360" data-scale="1" data-x="-5000" data-y="-7000" data-z="0"><h1 id="solr">SOLR</h1><ul><li>6 servers on Hetzner Cloud</li><li><em>180 req/s</em> during peak time</li><li>Worst mean response time: <em>125 ms</em></li><li>full redundancy, automatic fail over</li></ul></div><div class="step step-level-1" step="9" data-rotate-x="0" data-rotate-y="0" data-rotate-z="405" data-scale="1" data-x="-6000" data-y="-8000" data-z="0"><h1 id="docker">Docker</h1><p><em>170</em> containers running</p></div><div class="step step-level-1" step="10" data-rotate-x="0" data-rotate-y="0" data-rotate-z="450" data-scale="1" data-x="-7000" data-y="-9000" data-z="0"><h1 id="stability">Stability</h1><ul><li>99.9% availability of core services</li><li>limited failure impact</li><li>crappy cpu fans (6 were replaced)</li><li>still too many <strong>SPoFs</strong></li></ul></div><div class="step step-level-1" step="11" data-rotate-x="0" data-rotate-y="0" data-rotate-z="495" data-scale="1" data-x="-8000" data-y="-10000" data-z="0"><h1 id="soon">Soon...</h1><ul><li>work at reducing SPoFs</li><li>improved database backups using Barman</li><li>moving more services to VMs</li><li>upgrading to 18.04</li><li>upgrading docker + consul</li></ul></div><div class="step step-level-1" step="12" scale="3" data-z="8000" data-rotate-x="0" data-rotate-y="0" data-rotate-z="540" data-scale="1" data-x="-9000" data-y="-11000"><h1 id="thanks">Thanks !</h1><p>Made with <a href="https://github.com/regebro/hovercraft">Hovercraft</a></p></div></div><div class="footer"><p>"System &amp; Network Resources", Laurent Monin, MetaBrainz Summit 2018</p></div><div id="hovercraft-help" class="hide"><table><tr><th>Space</th><td>Forward</td></tr><tr><th>Right, Down, Page Down</th><td>Next slide</td></tr><tr><th>Left, Up, Page Up</th><td>Previous slide</td></tr><tr><th>G</th><td>Go to slide number</td></tr><tr><th>P</th><td>Open presenter console</td></tr><tr><th>H</th><td>Toggle this help</td></tr></table></div><script type="text/javascript" src="js/impress.js"></script><script type="text/javascript" src="js/impressConsole.js"></script><script type="text/javascript" src="js/hovercraft.js"></script></body></html>