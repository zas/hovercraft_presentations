:title: MetaBrainz Summit 2018 - Resources
:data-transition-duration: 1500
:css: mb2018.css
:skip-help: true

This is a presentation of system resources, their usage, etc for MetaBrainz Summit 2018

You can render this presentation to HTML with the command::

    hovercraft mb2018.rst

And connect with a browser to http://localhost:8000

.. header::

    .. image:: images/background.png

 
 .. footer::

    "System & Network Resources", Laurent Monin, MetaBrainz Summit 2018 

----

:data-x: 0
:data-y: 0
:data-z: 0
:data-rotate-x: 0
:data-rotate-y: 0
:data-rotate-z: 0
:scale: 1

MetaBrainz Summit 2018
======================

Our infrastructure
------------------


----

:data-rotate-z: r45
:data-x: 2000
:data-y: 0


Number of servers
=================

* Hetzner: 20 physical machines

* Hetzner Cloud: 8 virtual machines

* Google Cloud: 12 active instances

* Total: **40 servers**

.. note::

    TODO

----

:data-x: r-1000
:data-y: r-1000

Memory, storage, processing power
=================================

* 1.5 Terabytes of RAM

* 18 Terabytes of storage

* 1.7M Bogomips on 240 CPU cores


.. note::

    TODO.

----


Network traffic
===============

* *180 Terabytes* served this year

* *~50 mbits/s* out, *20 mbits/s* in


.. note::

    TODO

----


.. image:: images/ping_latency_world.png
    :height: 600px


----

:id: mbs1

MusicBrainz services
====================

Number of queries served this year
  
**11 Billions** of 200s answers


----


MusicBrainz services
====================

* Incoming Requests: *850 req/s*

* Handled by upstreams: **280 req/s**

----


Post QNAP
=========



Bandwidth usage went from

*120* mbits/s to *50* mbits/s


----

SOLR
====

* 6 servers on Hetzner Cloud
* *180 req/s* during peak time
* Worst mean response time: *125 ms*
* full redundancy, automatic fail over

----

Docker
======

*170* containers running


----

Stability
=================

* 99.9% availability of core services
* limited failure impact
* crappy cpu fans (6 were replaced)
* still too many **SPoFs**

----

Soon...
=======

* work at reducing SPoFs
* improved database backups using Barman
* moving more services to VMs
* upgrading to 18.04
* upgrading docker + consul


----

:scale: 3
:data-z: 8000
        
Thanks !
========

Made with Hovercraft_

.. _Hovercraft: https://github.com/regebro/hovercraft
